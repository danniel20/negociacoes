{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["currentInstance","negociacaoController","ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","_ordemAtual","inverteOrdem","ordena","p","s"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from \"../models/ListaNegociacoes\";\nimport {Mensagem} from \"../models/Mensagem\";\nimport {NegociacoesView} from \"../views/NegociacoesView\";\nimport {MensagemView} from \"../views/MensagemView\";\nimport {NegociacaoService} from \"../services/NegociacaoService\";\nimport {DateHelper} from \"../helpers/DateHelper\";\nimport {Bind} from \"../helpers/Bind\";\nimport {Negociacao} from \"../models/Negociacao\";\n\nclass NegociacaoController{\n\n\tconstructor(){\n\t\tlet $ = document.querySelector.bind(document);\n\t\tthis._inputData = $(\"#data\");\n\t\tthis._inputQuantidade = $(\"#quantidade\");\n\t\tthis._inputValor = $(\"#valor\");\n\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes,\n\t\t\t\t\t\t\t\t\t\t  new NegociacoesView($(\"#negociacoesView\")),\n\t\t\t\t\t\t\t\t\t\t  \"adiciona\", \"esvazia\", \"ordena\", \"inverteOrdem\"); \n\n\t\tthis._mensagem = new Bind(new Mensagem,\n\t\t\t                      new MensagemView($(\"#mensagemView\")),\n\t\t\t                      \"texto\");\n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\t_init(){\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes => \n\t\t\t\t\tnegociacoes.forEach(negociacao =>\n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch(erro => this._mensagem.texto = erro );\n\n\t\tsetInterval(() => {\n\t\t\tthis.importaNegociacoes();\n\t\t}, 5000);\t\n\t\t\n\t}\n\n\tadiciona(event){\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then( mensagem => {\n\t\t\t\tthis._listaNegociacoes.negociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro);\t\t\n\t}\n\n\timportaNegociacoes(){\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then(negociacoes => \n\t\t\t\t\tnegociacoes.forEach(negociacao => {\n\t\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)\n\t\t\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso\";\n\t\t\t}))\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\t}\n\n\tapaga(){\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t})\n\t\t\t.catch(erro => this._mensagem.texto = erro);\n\t}\n\n\t_criaNegociacao(){\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQuantidade.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\t_limpaFormulario(){\n\t\tthis._inputData.value = \"\";\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\t\tthis._inputData.focus();\n\t}\n\n\tordena(coluna) {\n        \n        if(this._ordemAtual == coluna) {\n            this._listaNegociacoes.inverteOrdem(); \n        } else {\n            this._listaNegociacoes.ordena((p, s) => p[coluna] - s[coluna]);    \n        }\n        this._ordemAtual = coluna;    \n    }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance(){\n\treturn negociacaoController;\n}"]}